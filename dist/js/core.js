"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};window.Core=function(t,e){var i={};return i}(jQuery,Vue),function(t,e,i){i.TabsMixin=function(t){return{data:function(){return{tabs:{active:t}}},methods:{activate:function(t){this.tabs.active=t},isActive:function(t){return this.tabs.active==t}}}},i.ActionMixin=function(t){return{props:{model:Object,globals:Object,context:Object},methods:{open:function(i){new t({data:{globals:this.globals,owner:this,context:i||this.context,original:this.model,current:JSON.parse(JSON.stringify(this.model))},methods:{submit:function(){this.owner.doApply(this.current),this.$remove(),this.$destroy()},reset:function(){this.$remove(),this.$destroy()}}}).$mount().$appendTo(e("body").get(0))},doApply:function(t){Object.assign(this.model,JSON.parse(JSON.stringify(t)),{_action:this.model._action?this.model._action:"update"}),e(window).trigger("resize")}}}},i.EditorMixin=function(t,i){return{props:{items:Array,globals:Object},methods:{trigger:function(t,e,i){this.$dispatch(t,{item:e,context:i})},create:function(t,n){new i({data:{globals:this.globals,owner:this,context:n,original:null,current:t?JSON.parse(JSON.stringify(t)):{}},methods:{submit:function(){this.owner.doCreate(this.current),this.$remove(),this.$destroy()},reset:function(){this.$remove(),this.$destroy()}}}).$mount().$appendTo(e("body").get(0))},remove:function(t,e){this.doRemove(t,e)},update:function(t,n){this.active=t,new i({data:{globals:this.globals,owner:this,context:n,original:t,current:JSON.parse(JSON.stringify(t))},methods:{submit:function(){this.owner.doUpdate(this.current),this.$remove(),this.$destroy()},reset:function(){this.$remove(),this.$destroy()}}}).$mount().$appendTo(e("body").get(0))},doCreate:function(t,i){this.items.push(Object.assign({},JSON.parse(JSON.stringify(t)),{_action:"create"})),this.$set("items",e.extend(!0,[],this.items)),e(window).trigger("resize"),this.active=null},doUpdate:function(t,i){Object.assign(this.active,JSON.parse(JSON.stringify(t)),{_action:this.active._action?this.active._action:"update"}),this.items=this.items.slice(),e(window).trigger("resize"),this.active=null},doRemove:function(t,i){var n=this.items.indexOf(t);if(n!==-1){var t=this.items[n];"create"==t._action?this.items.$remove(t):t._action="remove"}this.$set("items",e.extend(!0,[],this.items)),e(window).trigger("resize"),this.active=null}},events:{create:function(t){this.create(t.item,t.context)},update:function(t){this.update(t.item,t.context)},remove:function(t){this.remove(t.item,t.context)},doCreate:function(t){this.doCreate(t.item,t.context)},doUpdate:function(t){this.doUpdate(t.item,t.context)},doRemove:function(t){this.doRemove(t.item,t.context)}}}},i.ListViewerMixin={props:{items:Array,globals:Object},methods:{trigger:function(t,e){this.$dispatch(t,{item:item,context:context})},create:function(t,e){this.$dispatch("create",{item:t,context:e})},update:function(t,e){this.$dispatch("update",{item:t,context:e})},remove:function(t,e){this.$dispatch("remove",{item:t,context:e})}}},i.ModalEditorMixin={attached:function(){var t=this;e(this.$el).modal("show"),e(this.$el).on("hide.bs.modal",function(e){e.stopPropagation(),t.reset()})},detached:function(){e(this.$el).modal("hide")},methods:{submit:function(){},reset:function(){}}}}(Vue,jQuery,Core),function(t,e,i){i.WidgetMixin={props:{page:Object,data:Object,storage:Object,stack:Object,bindings:Object,children:Array,editable:Boolean},data:function(){return{systemId:this.systemId}},created:function(){this.randomId=e.service("palette").generateId("widget-"),this.$watch("bindings.id",function(t){t?this.systemId=t:this.systemId=this.randomId},{immediate:!0})},methods:{trigger:function(t,e,i){this.$dispatch(t,{item:e,context:i})}}},i.StackedMixin={props:{globals:Object,settings:Object,page:Object,data:Object,storage:Object,editable:Boolean,children:Array},data:function(){return{stackId:this.stackId}},created:function(){this.stackId=e.service("palette").generateId("stack-")}}}(jQuery,Vue,Core),function(t,e,i,n){function o(e,i){var n=this;this.$element=e,this.options=t.extend({},s,i),e.on("mousedown.sortable",this.options.itemSelector,function(t){n.handleStart(t)}),this.draggable=null,a.push(this)}var s={drag:!0,drop:!0,vertical:!0,containerSelector:"ol, ul",itemSelector:"li",excludeSelector:"",bodyClass:"dragging",activeClass:"active",draggedClass:"dragged",verticalClass:"vertical",horizontalClass:"horizontal",placeholderClass:"placeholder",placeholder:'<li class="placeholder"></li>',onDragStart:function(t,e,i){var n={height:t.$item.outerHeight(),width:t.$item.outerWidth()};t.$originalItem=t.$item,t.$item=t.$originalItem.clone().addClass(t.sortable.options.draggedClass).css({position:"fixed",left:e.pageX-t.adjustment.left,top:e.pageY-t.adjustment.top,width:n.width,height:n.height}).appendTo(t.$parent)},onDrag:function(t,e,i){t.$item.css({left:e.pageX-t.adjustment.left,top:e.pageY-t.adjustment.top})},onDrop:function(t,e,i){t.$item.remove(),t.location&&(t.$item=t.location.before?t.$item.insertBefore(t.location.$item):t.$item.insertAfter(t.location.$item),t.$item.css({position:"",left:"",top:"",width:"",height:""}))}},r=null,a=[];t(document).ready(function(){t(document).on("mouseup.sortable",function(t){r&&r.sortable.handleEnd(t,r)}).on("mousemove.sortable",function(t){r&&r.sortable.handleDrag(t,r)})}),o.prototype={dropLocation:function(e){var i,n;if(r){var o=r.$item.css("display");r.$item.css({display:"none"});for(var s=0;s<a.length;s++){var c=a[s];if(c.options.drop&&($result=t(document.elementFromPoint(e.pageX,e.pageY)).closest(c.options.itemSelector),$result.length&&$result.closest(c.$element).length)){i=$result,n=c;break}}r.$item.css({display:o})}else for(var s=0;s<a.length;s++){var c=a[s];if(c.options.drop&&($result=t(document.elementFromPoint(e.pageX,e.pageY)).closest(c.options.itemSelector),$result.length&&$result.closest(c.$element).length)){i=$result,n=c;break}}if(n&&i&&i.length){var l=i.closest(n.options.containerSelector),u=i.offset(),d={width:i.outerWidth(),height:i.outerHeight()},h=this.options.vertical?l.hasClass(n.options.horizontalClass)?"h":"v":l.hasClass(n.options.verticalClass)?"v":"h",p="h"==h?e.pageX-u.left<d.width/2:e.pageY-u.top<d.height/2;return{$item:i,$container:l,sortable:n,before:p}}return null},handleStart:function(e){if(this.options.excludeSelector&&t(e.target).closest(this.options.excludeSelector).length)return!0;var i=["TEXTAREA","INPUT","BUTTON","LABEL"];if(i.indexOf(t(e.target).prop("tagName"))<0&&(e.preventDefault(),e.stopPropagation()),!r){var n=t(e.target).closest(this.options.itemSelector),o=(n.parent(),n.offset());r={sortable:this,index:n.index(),$container:n.closest(this.options.containerSelector),$parent:n.parent(),$item:n,$originalItem:n,$targetItem:null,$targetContainer:null,location:this.dropLocation(e),adjustment:{left:e.clientX-o.left,top:e.clientY-o.top}},this.options.onDragStart(r,e,s.onDragStart)}},handleEnd:function(e){if(r){for(var i=0;i<a.length;i++){var n=a[i];t(n.options.containerSelector,n.$element).removeClass(n.options.activeClass)}r.$placeholder&&r.$placeholder.remove(),r.location=this.dropLocation(e),r.location?r.location.sortable.options.onDrop(r,e,s.onDrop):r.$item.remove(),r=null}},handleDrag:function(e){if(r){for(var i=0;i<a.length;i++){var n=a[i];t(this.options.containerSelector,n.$element).removeClass(this.options.activeClass)}r.$placeholder&&r.$placeholder.remove(),r.location=this.dropLocation(e),r.location&&(r.location.$container.addClass(r.location.sortable.options.activeClass),r.$placeholder=r.location.before?t(r.location.sortable.options.placeholder).insertBefore(r.location.$item):t(r.location.sortable.options.placeholder).insertAfter(r.location.$item)),r.sortable.options.onDrag(r,e,s.onDrag)}}};var c=t.extend(o.prototype,{enable:function(){},disable:function(){},destroy:function(){}});t.fn[i]=function(e){var s=Array.prototype.slice.call(arguments,1);return this.map(function(){var r=t(this),a=r.data(i);return a&&c[e]?c[e].apply(a,s)||this:(a||e!==n&&"object"!==("undefined"==typeof e?"undefined":_typeof(e))||r.data(i,new o(r,e)),this)})}}(jQuery,window,"sortable"),function(t,e){Vue.directive("affix",{bind:function(){t.fn.affix&&t(this.el).affix(this.vm.$get(this.expression))},update:function(t,e){},unbind:function(){}})}(jQuery,Core),function(t,e){Vue.directive("combo",{bind:function(){t.fn.tagsinput&&t(this.el).select2({tags:!0,multiple:!1,createTag:function(t){return{id:t.term,text:t.term,newOption:!0}}})},update:function(t,e){},unbind:function(){}})}(jQuery,Core),function(t,e){Vue.directive("date",{bind:function(){t.fn.datepicker&&t(this.el).datepicker({autoclose:!0,todayHighlight:!0,format:"yyyy-mm-dd"})},update:function(t,e){},unbind:function(){}})}(jQuery,Core),function(t,e){Vue.directive("rich",{bind:function(){window.CKEDITOR&&(this.editor=CKEDITOR.inline(this.el,{stylesSet:[{name:"Bolder",element:"span",attributes:{class:"extrabold"}}],toolbarGroups:[{name:"links"},{name:"tools"},{name:"document",groups:["mode","document","doctools"]},{name:"others"},{name:"paragraph",groups:["list","indent","blocks","align"]},{name:"colors"},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"styles"},"/",{name:"insert",groups:["ImageButton"]}]}),this.editor.on("change",function(){this.editor.updateElement(),this.vm.$set(this.expression,t(this.el).val())}.bind(this)),this.editor.setData(this.vm.$get(this.expression)))},update:function(t,e){},unbind:function(){this.editor.destroy(),this.editor=null,this.textarea=null,this.input=null}})}(jQuery,Core),function(t,e){Vue.directive("scrollable",{bind:function(){t.fn.perfectScrollbar&&Vue.nextTick(function(){t(this.el).perfectScrollbar({})}.bind(this))},update:function(t,e){},unbind:function(){}})}(jQuery,Core),function(t,e){Vue.directive("tags",{bind:function(){t.fn.tagsinput&&t(this.el).tagsinput({})},update:function(t,e){},unbind:function(){}})}(jQuery,Core),function(t,e){t(document).ready(function(){function e(e){var i=t(e),n=t(".modal-dialog",i);i.css("display","block"),n.css("margin-top",Math.max(0,(t(window).height()-n.height())/2))}t(t(document),".modal.modal-center").on("show.bs.modal",function(t){e(t.target)}),t(window).on("resize",function(){t(".modal.modal-center:visible").each(function(t,i){e(i)})})})}(jQuery,Core),function(t,e){Vue.filter("jsonPath",function(t,e){if(void 0!==e&&void 0!==t){var i=/{([^}]+)}/g;return result=e.replace(i,function(e,i){return json=JSONPath({json:t,path:i}),json.hasOwnProperty(1)?"array":json}),"array"==result?JSONPath({json:t,path:e.replace(i,"$1")}):result}}),Vue.filter("template",function(t,e){var i=/${([^}]+)}/g;return t.replace(i,function(t,i){return e[i]})}),Vue.filter("assign",function(t,e,i,n){return Object.assign(t,e,i,n)}),Vue.filter("copy",function(t){return new Vue({data:null!=t?JSON.parse(JSON.stringify(t)):null}).$data}),Vue.filter("clone",function(t){return new Vue({data:null!=t?JSON.parse(JSON.stringify(t)):null}).$data})}(jQuery,Core),function(t,e,i){e.use({install:function(t,e){var i={};t.service=function(t,e){return i[t]=i[t]||e}}})}(jQuery,Vue,Core),function(t,e){Vue.validator("email",function(t){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)})}(jQuery,Core);